"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[1190],{605:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/features-a73ae32cb4391fdd586e23d450e6f2d7.png"},2292:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/fast-api-4ed5595066ba8b486810824e9770c6eb.png"},3685:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>d,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"contribute/development-guide/coding/extending-the-api/index","title":"Extending the API","description":"FastAPI","source":"@site/docs/contribute/development-guide/coding/extending-the-api/index.md","sourceDirName":"contribute/development-guide/coding/extending-the-api","slug":"/contribute/development-guide/coding/extending-the-api/","permalink":"/template-fastapi-react/docs/contribute/development-guide/coding/extending-the-api/","draft":false,"unlisted":false,"editUrl":"https://github.com/equinor/template-fastapi-react/tree/main/documentation/docs/contribute/development-guide/coding/extending-the-api/index.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"contribute","previous":{"title":"Architecture overview","permalink":"/template-fastapi-react/docs/contribute/development-guide/coding/architecture"},"next":{"title":"Adding entities","permalink":"/template-fastapi-react/docs/contribute/development-guide/coding/extending-the-api/adding-entities"}}');var s=t(4848),a=t(8453),r=t(1028);const o='from pydantic import Field\nfrom pydantic_settings import BaseSettings\n\nfrom authentication.models import User\nfrom common.logger_level import LoggerLevel\n\n\nclass Config(BaseSettings):\n    # Pydantic-settings in pydantic v2 automatically fetch config settings from env-variables\n    ENVIRONMENT: str = "local"\n\n    # Logging\n    LOGGER_LEVEL: LoggerLevel = Field(default=LoggerLevel.INFO)\n    APPINSIGHTS_CONSTRING: str | None = None\n\n    # Database\n    MONGODB_USERNAME: str = "dummy"\n    MONGODB_PASSWORD: str = "dummy"  # noqa: S105\n    MONGODB_HOSTNAME: str = "db"\n    MONGODB_DATABASE: str = "test"\n    MONGODB_PORT: int = 27017\n\n    # Access control\n    APPLICATION_ADMIN: str = "admin"\n    APPLICATION_ADMIN_ROLE: str = "admin"\n\n    # Authentication\n    SECRET_KEY: str | None = None\n    AUTH_ENABLED: bool = False\n    JWT_SELF_SIGNING_ISSUER: str = "APPLICATION"  # Which value will be used to sign self-signed JWT\'s\n    TEST_TOKEN: bool = False  # This value should only be changed at runtime by test setup\n    OAUTH_WELL_KNOWN: str | None = None\n    OAUTH_TOKEN_ENDPOINT: str = ""\n    OAUTH_AUTH_ENDPOINT: str = ""\n    OAUTH_CLIENT_ID: str = ""\n    OAUTH_AUTH_SCOPE: str = ""\n    OAUTH_AUDIENCE: str = ""\n    MICROSOFT_AUTH_PROVIDER: str = "login.microsoftonline.com"\n\n    @property\n    def log_level(self) -> str:\n        """Returns LOGGER_LEVEL as a (lower case) string."""\n        return str(self.LOGGER_LEVEL.value).lower()\n\n\nconfig = Config()\n\nif config.AUTH_ENABLED and not all((config.OAUTH_AUTH_ENDPOINT, config.OAUTH_TOKEN_ENDPOINT, config.OAUTH_WELL_KNOWN)):\n    raise ValueError("Authentication was enabled, but some auth configuration parameters are missing")\n\nif not config.AUTH_ENABLED:\n    print("\\n")\n    print("################ WARNING ################")\n    print("#       Authentication is disabled      #")\n    print("################ WARNING ################\\n")\n\ndefault_user: User = User(\n    user_id="nologin",\n    full_name="Not Authenticated",\n    email="nologin@example.com",\n)\n',d={sidebar_position:2},c="Extending the API",l={},h=[{value:"FastAPI",id:"fastapi",level:2},{value:"Codebase structure",id:"codebase-structure",level:2},{value:"Get started",id:"get-started",level:2},{value:"Configuration",id:"configuration",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"extending-the-api",children:"Extending the API"})}),"\n",(0,s.jsx)(n.h2,{id:"fastapi",children:"FastAPI"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://github.com/tiangolo/fastapi",children:"FastAPI"})," is a high-performant REST API framework for Python. It's built on top of ",(0,s.jsx)(n.a,{href:"https://github.com/encode/starlette",children:"Starlette"}),", an ASGI (Asynchronous Server Gateway Interface) implementation for Python, and it uses ",(0,s.jsx)(n.a,{href:"https://github.com/pydantic/pydantic",children:"Pydantic"})," for data validation. It can generate ",(0,s.jsx)(n.a,{href:"https://swagger.io/docs/specification/about/",children:"OpenAPI"})," documentation from your code and also produces a ",(0,s.jsx)(n.a,{href:"https://swagger.io/tools/swagger-ui/",children:"Swagger UI"})," that you can use to test your application. OpenAPI uses a subset of ",(0,s.jsx)(n.a,{href:"https://json-schema.org/",children:"JSON Schema"})," to describe APIs and define the validation rules of the\nAPI payloads and parameters."]}),"\n",(0,s.jsxs)(n.p,{children:["To run FastAPI applications, we use the process manager ",(0,s.jsx)(n.a,{href:"https://github.com/encode/uvicorn",children:"uvicorn"}),". Check out the official ",(0,s.jsx)(n.a,{href:"https://fastapi.tiangolo.com/deployment/server-workers/",children:"documentation"})," for more details."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"FastAPI",src:t(2292).A+"",width:"616",height:"743"})}),"\n",(0,s.jsx)(n.h2,{id:"codebase-structure",children:"Codebase structure"}),"\n",(0,s.jsx)(n.p,{children:"The API is grouped by features."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Features",src:t(605).A+"",width:"2374",height:"1414"})}),"\n",(0,s.jsxs)(n.p,{children:["The API has a feature-based folder structure following the principles of ",(0,s.jsx)(n.a,{href:"/template-fastapi-react/docs/contribute/development-guide/coding/architecture",children:"Clean Architecture"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u251c\u2500\u2500 api/\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 common/\n\u2502       \u251c\u2500\u2500 entities/\n\u2502       \u251c\u2500\u2500 features/\n\u2502       \u2502   \u251c\u2500\u2500 health_check/\n\u2502       \u2502   \u251c\u2500\u2500 todo/\n\u2502       \u2502   \u251c\u2500\u2500 whoami/\n\u2502       \u2502   \u2514\u2500\u2500 ...\n\u2502       \u251c\u2500\u2500 data_providers/\n\u2502       \u2514\u2500\u2500 tests/\n\u2502           \u251c\u2500\u2500 unit/\n\u2502           \u2514\u2500\u2500 integration/\n\u2514\u2500\u2500 ...\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"common"})," contains shared code like authentication, exceptions, response decorator"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/template-fastapi-react/docs/contribute/development-guide/coding/extending-the-api/adding-entities",children:(0,s.jsx)(n.code,{children:"entities"})})," contains all entities, enums, exceptions, interfaces, types and logic specific to the domain layer"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"adding-features",children:(0,s.jsx)(n.code,{children:"features"})})," contains use-cases (application logic), repository interfaces, and controllers"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"adding-data-providers",children:(0,s.jsx)(n.code,{children:"data providers"})})," contains classes for accessing external resources such as databases, file systems, web services, and repository implementations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"tests"})," contains unit and integrations tests"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"get-started",children:"Get started"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Create the domain model by ",(0,s.jsx)(n.a,{href:"/template-fastapi-react/docs/contribute/development-guide/coding/extending-the-api/adding-entities",children:"adding entities"})]}),"\n",(0,s.jsxs)(n.li,{children:["Extend the API by ",(0,s.jsx)(n.a,{href:"adding-features",children:"adding features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Add a ",(0,s.jsx)(n.a,{href:"/template-fastapi-react/docs/contribute/development-guide/coding/extending-the-api/adding-features/use-cases",children:"use case"})," to handle application logic"]}),"\n",(0,s.jsxs)(n.li,{children:["Add a ",(0,s.jsx)(n.a,{href:"/template-fastapi-react/docs/contribute/development-guide/coding/extending-the-api/adding-features/controllers",children:"controller"})," to handle API requests","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Add an endpoint to the controller that executes the use case"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Add a data provider, ",(0,s.jsx)(n.a,{href:"/template-fastapi-react/docs/contribute/development-guide/coding/extending-the-api/adding-data-providers/repository-interfaces",children:"repository interface"})," and ",(0,s.jsx)(n.a,{href:"/template-fastapi-react/docs/contribute/development-guide/coding/extending-the-api/adding-data-providers/repositories",children:"repository"})," to handle communication to external services such as databases."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Entities and data providers can be shared between features (the entrypoints and use-cases)."})}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["All configuration parameters are expected to be environment variables, and are defined in this file ",(0,s.jsx)(n.code,{children:"api/src/config.py"}),"."]}),"\n","\n",(0,s.jsx)(r.A,{language:"jsx",children:o}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"../../../../about/running/configure",children:"configuration"})," for a description of the different configuration options available."]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}}}]);